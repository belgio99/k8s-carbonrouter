# This file contains the default values for the carbonrouter umbrella chart.
# It is used to set default values for the chart and its dependencies.

rabbitmq:
  auth:
    username: carbonuser
    password: supersecret
    erlangCookie: verysecretcookie
  replicaCount: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
  clustering:
    forceBoot: true
  metrics:
    enabled: true
    

# Istio component configuration
base:
  # Assuming 'base' chart doesn't install namespaced resources directly or respects Release.Namespace
  # No specific namespace override needed here typically, but monitor if errors persist.
  {}

global:
  istioNamespace: carbonrouter-system
  hub: docker.io/istio
  tag: 1.25.0
  proxy:
    autoInject: disabled

istiod:
  namespace: carbonrouter-system
  sidecarInjectorWebhook:
    enableNamespacesByDefault: false

gateway:
  name: gateway
  namespace: carbonrouter-system
# Add other sub-chart overrides below if needed
# Disable sidecar injection for non-gateway pods
decision-engine:
  podAnnotations:
    sidecar.istio.io/inject: "false"
  env:
    - name: THROTTLE_MIN
      value: "0.15"
    - name: THROTTLE_INTENSITY_FLOOR
      value: "100"
    - name: THROTTLE_INTENSITY_CEILING
      value: "300"
    - name: TARGET_ERROR
      value: "0.10"
    - name: CREDIT_MAX
      value: "1.5"
buffer-service:
  podAnnotations:
    sidecar.istio.io/inject: "true"
carbonrouter-operator:
  podAnnotations:
    sidecar.istio.io/inject: "false"

grafana:
  dashboards:
    enabled: true
    label: grafana_dashboard
    labelValue: "1"

kube-prometheus-stack:
  kube-state-metrics:
    metricLabelsAllowlist:
      - deployments=[*]
      - pods=[*]
      - namespaces=[*]
      - services=[*]
  prometheus-node-exporter:
    hostRootFsMount:
      enabled: false
  grafana:
    enabled: true
    sidecar:
      dashboards:
        enabled: true
        label: grafana_dashboard
        labelValue: "1"
        searchNamespace: ALL
    adminPassword: admin